{% set page = 'tank' %}
{% extends "layout.html" %}
{% block title %}Eau - {% endblock %}

{% block content %}
{% if state["emergency_stop"] %}
    <p>Le système est éteint.</p>
    <p>
        <a href="{{ url_for('tank.emergency_stop', on=0) }}">Allumer</a>
    </p>
{% else %}
    <p>Le système est allumé.</p>
    <p>
        <a href="{{ url_for('tank.emergency_stop', on=1) }}">Eteindre</a>
    </p>
{% endif %}
<svg id="schema"></svg>
{% endblock %}

{% block js %}
<script src="{{ url_for('static', filename='js/rough.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/tank.js') }}"></script>
<script>
    Tank(document.getElementById("schema"), {
        waterLevel: {{ water_level }},
        flowIn: {{ state["flow_in"] }},
        flowOut: {{ state["flow_out"] }},
        pumpIn: {{ state["pump_in"] }},
        pumpOut: {{ state["pump_out"] }},
        isMotorInBlocked: {{ state["is_motor_in_blocked"] }},
        isMotorOutBlocked: {{ state["is_motor_out_blocked"] }},
        isFilterInBlocked: {{ state["is_filter_in_blocked"] }},
        isOverpressured: {{ state["is_overpressured"] }},
        isTankFull: {{ state["is_tank_full"] }},
        isTankEmpty: {{ state["is_tank_empty"] }},
        timeToWellFull: {{ time_to_well_full }},
    }, {
        pumpInOn: "{{ url_for('tank.pump_in', on=1) }}",
        pumpInOff: "{{ url_for('tank.pump_in', on=0) }}",
        pumpOutOn: "{{ url_for('tank.pump_out', on=1) }}",
        pumpOutOff: "{{ url_for('tank.pump_out', on=0) }}",
    });
</script>
{% endblock %}
